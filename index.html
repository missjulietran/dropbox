<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Julie's Dropbox</title>
    <!-- <link rel="stylesheet" href="./public/main.css"> -->
</head>


<h1>Julie's Dropbox</h1>



<form action="/upload" method='post' id="uploadedForm" enctype='multipart/form-data'>
    Files: <input type="file" id="upload" name='foo' multiple size='50' onchange="myFunction()">
    <label for="upload" id="uploadLabel"></label>
    <div id="selectedFiles"></div>
    <input type="submit" value="Upload" id="submit">
</form>

<form action='/download' method='get' id="buttonName" enctype='multipart/form-data'>
    <button>download the file</button>

    <p id='fileInformation'>

    </p>
    <p id='files'></p>
</form>


<script>

    // document.getElementById('uploadedForm').addEventListener('submit',(event)=>{
    //     event.preventDefault()

    //     // jquery logic to post a file
    //     $.post('/upload', {})

    //     // then use the response to render out the file names on the page
    //         //first console log response
    //         // iterate through the array
    //         // append a button with the action to the download/filename

    // })


    function myFunction() {
        let x = document.getElementById('upload');
        let txt = '';

        if ('files' in x) {
            if (x.files.length == 0) {
                txt = 'Select one or more files.';
            } else {


                // name.setAttribute(action, `/download/${file.name}`)


                for (var i = 0; i < x.files.length; i++) {
                    txt += "<br><strong>" + (i + 1) + ". file</strong><br>";
                    var file = x.files[i];
                    if ('name' in file) {
                        txt += 'name: ' + file.name + '<br>';
                    }
                    if ('size' in file) {
                        txt += 'size: ' + file.size + ' bytes <br>';
                    }


                let name = document.getElementById('buttonName')
                console.log(name)

                name.action= `/download/${file.name}`

                }
            }
        } else {
            if (x.value == '') {
                txt += 'Select one or more files.';
            } else {
                txt += "The files property is not supported by your browser!";
                txt += "<br>The path of the selected file: " + x.value;
            }
        }

        document.getElementById('fileInformation').innerHTML=txt;



    }

</script>

    </body>



</html>


